import{d as I,r as c,j as t}from"./index-D0FqdMLg.js";import{F as d,a as L,M,I as y,U as N,B as u,s as n,b as g}from"./axios-B6PH2qyw.js";const T=I(u)`
  margin-bottom: 16px;
`,x=async()=>{try{return(await g.get("http://95.85.121.153:5634/product-group")).data}catch(r){throw n.error("Failed to fetch categories"),r}},A=async r=>{try{return(await g.post("http://95.85.121.153:5634/product-group",r,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(s){throw n.error("Failed to add category"),s}},D=async r=>{try{return(await g.patch(`http://95.85.121.153:5634/product-group/${r.get("id")}`,r,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(s){throw n.error("Failed to update category"),s}},S=async r=>{try{await g.delete(`http://95.85.121.153:5634/product-group/${r}`)}catch(s){throw n.error("Failed to delete category"),s}},O=()=>{const[r,s]=c.useState([]),[C,m]=c.useState(!1),[o,p]=c.useState(null),[i]=d.useForm();c.useEffect(()=>{(async()=>{try{const a=await x();s(a)}catch{n.error("Failed to fetch categories")}})()},[]),c.useEffect(()=>{o?i.setFieldsValue({name_tm:o.name_tm,name_en:o.name_en,name_ru:o.name_ru}):i.resetFields()},[o,i]);const j=()=>{p(null),m(!0)},F=e=>{p(e),m(!0)},_=e=>{S(e).then(()=>{n.success("Category deleted successfully"),s(r.filter(a=>a.id!==e))}).catch(()=>n.error("Failed to delete category"))},w=async e=>{var f;const a=new FormData;a.append("name_tm",e.name_tm),a.append("name_en",e.name_en),a.append("name_ru",e.name_ru);const h=((f=e.file)==null?void 0:f.fileList)||[];if(h.length>0){const l=h[0].originFileObj;l&&a.append("file",l)}try{o?(a.append("id",o.id.toString()),await D(a),n.success("Category updated successfully")):(await A(a),n.success("Category added successfully")),m(!1);const l=await x();s(l)}catch(l){console.error("Error:",l),n.error("Failed to save category")}},b=()=>{m(!1)},k=e=>{var a;e.fileList&&Array.isArray(e.fileList)&&((a=e.fileList[0])!=null&&a.originFileObj)&&i.setFieldsValue({file:[e.fileList[0]]})},E=[{title:"Image",dataIndex:"image",key:"image",render:e=>t.jsx("img",{src:e,alt:"Category",style:{width:50,height:50}})},{title:"Name (Turkmen)",dataIndex:"name_tm",key:"name_tm"},{title:"Name (English)",dataIndex:"name_en",key:"name_en"},{title:"Name (Russian)",dataIndex:"name_ru",key:"name_ru"},{title:"Actions",key:"actions",render:e=>t.jsxs(t.Fragment,{children:[t.jsx(u,{style:{marginRight:"10px"},onClick:()=>F(e),children:"Edit"}),t.jsx(u,{onClick:()=>_(e.id),children:"Delete"})]})}];return t.jsxs("div",{children:[t.jsx(T,{type:"primary",onClick:j,children:"Add Category"}),t.jsx(L,{dataSource:r,columns:E,rowKey:"id"}),t.jsx(M,{title:o?"Edit Category":"Add Category",visible:C,onOk:()=>i.submit(),onCancel:b,width:800,children:t.jsxs(d,{form:i,layout:"vertical",onFinish:w,children:[t.jsx(d.Item,{name:"name_tm",label:"Category Name (Turkmen)",rules:[{required:!0,message:"Please enter the category name (Turkmen)"}],children:t.jsx(y,{})}),t.jsx(d.Item,{name:"name_en",label:"Category Name (English)",rules:[{required:!0,message:"Please enter the category name (English)"}],children:t.jsx(y,{})}),t.jsx(d.Item,{name:"name_ru",label:"Category Name (Russian)",rules:[{required:!0,message:"Please enter the category name (Russian)"}],children:t.jsx(y,{})}),t.jsx(d.Item,{name:"file",label:"Category Image",valuePropName:"fileList",getValueFromEvent:e=>e.fileList,children:t.jsx(N,{listType:"picture",beforeUpload:()=>!1,onChange:k,children:t.jsx(u,{children:"Upload"})})})]})})]})};export{O as default};
